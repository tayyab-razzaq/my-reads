(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(e,t,n){e.exports=n(29)},22:function(e,t,n){},24:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var a=n(5),o=n(6),r=n(8),s=n(7),i=n(9),c=n(0),l=n.n(c),u=n(13),h=n.n(u),m=(n(22),n(32)),f=(n(24),n(10)),d={currentlyReading:"Currently Reading",wantToRead:"Want to Read",read:"Read"},b=Object(f.a)({},d,{none:"None"}),k=["Android","Art","Artificial Intelligence","Astronomy","Austen","Baseball","Basketball","Bhagat","Biography","Brief","Business","Camus","Cervantes","Christie","Classics","Comics","Cook","Cricket","Cycling","Desai","Design","Development","Digital Marketing","Drama","Drawing","Dumas","Education","Everything","Fantasy","Film","Finance","First","Fitness","Football","Future","Games","Gandhi","Homer","Horror","Hugo","Ibsen","Journey","Kafka","King","Lahiri","Larsson","Learn","Literary Fiction","Make","Manage","Marquez","Money","Mystery","Negotiate","Painting","Philosophy","Photography","Poetry","Production","Programming","React","Redux","River","Robotics","Rowling","Satire","Science Fiction","Shakespeare","Singh","Swimming","Tale","Thrun","Time","Tolstoy","Travel","Ultimate","Virtual Reality","Web Development","iOS"],v=function(e){var t=b,n=Object.keys(t).map(function(e,n){return l.a.createElement("option",{key:n,value:e},t[e])});return l.a.createElement("div",{className:"book-shelf-changer"},l.a.createElement("select",{value:e.value,onChange:function(t){return e.onChange(t.target.value)}},l.a.createElement("option",{value:"move",disabled:!0},"Move to..."),n))},p=function(e){var t=e.title,n=e.authors,a=e.imageLinks,o=e.bookShelf;return l.a.createElement("div",null,l.a.createElement("div",{className:"book"},l.a.createElement("div",{className:"book-top"},l.a.createElement("div",{className:"book-cover",style:{width:128,height:192,backgroundImage:'url("'.concat(a.thumbnail,'")')}}),l.a.createElement(v,{value:o,onChange:e.onChange})),l.a.createElement("div",{className:"book-title"},t),l.a.createElement("div",{className:"book-authors"},n?n.join(", "):"")))},g=function(e){var t=e.title,n=e.books;return l.a.createElement("div",{className:"bookshelf"},l.a.createElement("h2",{className:"bookshelf-title"},t),l.a.createElement("div",{className:"bookshelf-books"},l.a.createElement("ol",{className:"books-grid"},n.map(function(t,n){return l.a.createElement("li",{key:n},l.a.createElement(p,Object.assign({},t,{onChange:function(t){return e.onChange(n,t,e.bookShelf)},bookShelf:e.bookShelf})))}))))},y="https://reactnd-books-api.udacity.com",E=localStorage.token;E||(E=localStorage.token=Math.random().toString(36).substr(-8));var S={Accept:"application/json",Authorization:E},C=function(){return fetch("".concat(y,"/books"),{headers:S}).then(function(e){return e.json()}).then(function(e){return e.books})},j=function(e,t){return fetch("".concat(y,"/books/").concat(e.id),{method:"PUT",headers:Object(f.a)({},S,{"Content-Type":"application/json"}),body:JSON.stringify({shelf:t})}).then(function(e){return e.json()})},O=function(e){return fetch("".concat(y,"/search"),{method:"POST",headers:Object(f.a)({},S,{"Content-Type":"application/json"}),body:JSON.stringify({query:e})}).then(function(e){return e.json()}).then(function(e){return e.books})},N=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(s.a)(t).call(this,e))).onStatusChange=function(e,t,a,o){if(a!==o){var r=n.state,s=r.books,i=r.bookShelves[e].books[t];j(i,a).then(function(e){var t=Object.keys(e).map(function(t){var n=e[t],a=s.filter(function(e){return n.includes(e.id)});return{title:d[t],books:a,bookShelf:t}});n.setState({bookShelves:t})})}},n.state={books:[],bookShelves:[],dataLoaded:!1},n}return Object(i.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;C().then(function(t){var n=Object.keys(d).map(function(e){var n=t.filter(function(t){return t.shelf===e});return{title:d[e],books:n,bookShelf:e}});e.setState({books:t,bookShelves:n,dataLoaded:!0})})}},{key:"render",value:function(){var e=this,t=this.state,n=t.bookShelves;return t.dataLoaded?l.a.createElement("div",{className:"list-books"},l.a.createElement("div",{className:"list-books-title"},l.a.createElement("h1",null,"MyReads")),l.a.createElement("div",{className:"list-books-content"},n.map(function(t,n){return l.a.createElement(g,Object.assign({key:n},t,{onChange:function(t,a,o){return e.onStatusChange(n,t,a,o)}}))})),l.a.createElement("div",{className:"open-search"},l.a.createElement("button",{onClick:function(){return e.props.history.push("/search")}},"Add a book"))):l.a.createElement("div",null)}}]),t}(c.Component),w=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(s.a)(t).call(this,e))).searchBooks=function(){var e=n.state,t=e.shelvedBooks,a=e.query;O(a).then(function(e){e=Object.getPrototypeOf(e)===Array.prototype?(e=e.filter(function(e){return void 0!==e.imageLinks})).map(function(e){var n=t.findIndex(function(t){return t.id===e.id});return e.shelf=-1===n?"none":t[n].shelf,e}):[],n.setState({books:e})})},n.isValidQuery=function(e){return k.filter(function(t){return t.toLowerCase().includes(e.toLowerCase())}).length>0},n.onSearchChange=function(e){e.length>2&&n.isValidQuery(e)?n.setState({query:e},n.searchBooks):n.setState({books:[],query:e})},n.onStatusChange=function(e,t){var a=n.state.books,o=n.state.shelvedBooks,r=a[t];r.shelf!==e&&j(r,e).then(function(){"none"===r.shelf?o.push({id:r.id,shelf:e}):"none"===e?o=o.filter(function(e){return r.id!==e.id}):o.map(function(t){return t.id===r.id&&(t.shelf=e),t}),a[t].shelf=e,n.setState({books:a,shelvedBooks:o})})},n.state={query:"",books:[],shelvedBooks:[]},n}return Object(i.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;C().then(function(t){var n=t.map(function(e){return{id:e.id,shelf:e.shelf}});e.setState({shelvedBooks:n})})}},{key:"render",value:function(){var e=this,t=this.state,n=t.books,a=t.query;return l.a.createElement("div",{className:"search-books"},l.a.createElement("div",{className:"search-books-bar"},l.a.createElement("button",{className:"close-search",onClick:function(){return e.props.history.push("/")}},"Close"),l.a.createElement("div",{className:"search-books-input-wrapper"},l.a.createElement("input",{type:"text",placeholder:"Search by title or author",value:a,onChange:function(t){return e.onSearchChange(t.target.value.trim())}}))),l.a.createElement("div",{className:"search-books-results"},l.a.createElement("ol",{className:"books-grid"},n.map(function(t,n){return l.a.createElement("li",{key:n},l.a.createElement(p,Object.assign({},t,{onChange:function(t){return e.onStatusChange(t,n)},bookShelf:t.shelf})))}))))}}]),t}(c.Component),B=n(30),R=n(31),L=l.a.createElement(B.a,null,l.a.createElement(R.a,{exact:!0,path:"/my-reads",component:N}),l.a.createElement(R.a,{exact:!0,path:"/my-reads/search",component:w})),M=function(){return l.a.createElement("div",{className:"app"},L)},D=n(15),T=function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return l.a.createElement(m.a,{history:Object(D.a)()},l.a.createElement(M,null))}}]),t}(c.Component);h.a.render(l.a.createElement(T,null),document.getElementById("root"))}},[[17,2,1]]]);
//# sourceMappingURL=main.6e977a57.chunk.js.map